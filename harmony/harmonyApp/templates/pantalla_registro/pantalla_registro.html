{% load static %}

<html>

<head>
    <link rel="icon" href="{% static '/images/icono.png' %}" type="image/x-icon">

    <title>Registrate</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous">
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        #logoNavbar {
            margin: 5px;
            margin-bottom: 15px;
            width: 300px;
            height: 100%;
        }
        #navbar{
            position: fixed;
            background-color: #D9D9D9;
            text-align: center;
            width: 100%;
            height: 60px;
            padding-bottom: 10px;
        }
        .form-control {
            border-radius: 17px;
            background: #E9DEB3;
            box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);
        }

        .form-control:active,
        .form-control:focus {
            background-color: #bbb395;
            /* Color oscurecido al hacer clic o enfocar el input */
        }

        .centered-div {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #formulario {
            width: 40%;
            padding-bottom: 100px;
        }

        #body {
            background-color: #F1F0EC;
        }

        #titulo {
            text-align: center;
        }

        #cont_button {
            display: flex;
            justify-content: center;
            align-items: center;
            padding-top: 20px;
        }

        #boton1 {
            border-radius: 17px;
            background: #3853FF;
            width: 35%;
        }

        #boton2 {
            border-radius: 17px;
            background: #3853FF;
            width: 40%;
        }

        #cont_img {

            margin-left: -14%;
            flex-shrink: 0;
        }

        #img {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 5;
            max-width: 100%;
            height: 50%;
        }

        #contendor {
            padding-top: 30px;
            display: flex;
            align-items: flex-start;
        }
        .form-label{
            font-size: 20px;
        }
        .oculto {
            display: none;
        }
        
        .spinner {
            border: 9px solid rgba(0, 0, 0, 0.1);
            border-left: 9px solid white;
            border-radius: 50%;
            width: 65px;
            height: 65px;
            animation: spin 1s linear infinite;
            margin: auto;
            z-index: 9999;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Selecciona el formulario por su id
            var formulario = document.getElementById("formulario");
            

            formulario.addEventListener("submit", function (event) {
                // Agrega aquí tus validaciones para cada campo
                var nombre = document.getElementById("id_nombre").value;
                var apellido = document.getElementById("id_apellido").value;
                var correo = document.getElementById("id_correo").value;
                var clave = document.getElementById("id_clave").value;
                var claveDoble = document.getElementById("id_clave_doble").value;
                var genero = document.getElementById("id_genero").value;
                var fechaNacimiento = document.getElementById("id_fecha_nacimiento").value;
                var valido = true;
                var mensaje = "";
                if (nombre === "" || apellido === "" || correo === "" || clave === "" || genero ===
                    "" || fechaNacimiento === "") {
                    // Si algún campo está vacío, muestra un mensaje de error y evita enviar el formulario
                    mensaje="Por favor, complete todos los campos.";
                    valido = false;
                    
                } else if (clave !== claveDoble) {
                    // Si las contraseñas no son iguales, muestra un mensaje de error y evita enviar el formulario
                    mensaje="Las contraseñas no coinciden.";
                    valido = false;
                } else {
                    var fechaActual = new Date();
                    var fechaNacimientoDate = new Date(fechaNacimiento);
                    var diferenciaTiempo = fechaActual - fechaNacimientoDate;
                    var edad = Math.floor(diferenciaTiempo / (365.25 * 24 * 60 * 60 * 1000));

                    if (edad < 14) {
                        mensaje="Recuerda que la aplicación es para adolescentes de 14 años en adelante";
                        valido = false;
                    }
                }
                if (valido==true) {
                    mostrarCarga();
                }else{
                    alert(mensaje);
                    event.preventDefault();
                }
            });
        });
        function mostrarCarga() {
            var carga = document.getElementById("carga");
            carga.classList.remove("oculto");

            setTimeout(function () {
                carga.classList.add("oculto");
            }, 8000); // Cambia 3000 por el tiempo real de tu proceso
        }
        $(document).ready(function () {

            var columnChat = document.getElementById('main');
            columnChat.scrollTop = columnChat.scrollHeight;
        });
    </script>


</head>

<body id="body">
    <div>
        <header id="navbar">
            <img id="logoNavbar" src="{% static '/images/nuevo_logo.png'  %}">
        </header>

        <main>


            <div id="contendor" class="container">

                <div class="centered-div">
                    <div id="carga" class="oculto">
                        <div class="spinner"></div>
            
                    </div>
                    <form id="formulario" method="POST" action="{% url 'pantalla_registro' %}"
                        enctype="multipart/form-data">
                        <div id="titulo">
                            <br>
                            <br>
                            <h1>
                                Crear una cuenta
                            </h1>
                            <br>

                        </div>

                        {% csrf_token %}
                        <label for="id_nombre" class="form-label">Nombre:</label>
                        <input type="text" class="form-control" id="id_nombre" name="nombre"
                            aria-describedby="emailHelp" >
                        <br>
                        <label for="id_apellido" class="form-label">Apellido:</label>
                        <input type="text" class="form-control" id="id_apellido" name="apellido"
                            aria-describedby="emailHelp" >
                        <br>
                        <label for="id_correo" class="form-label">Correo electrónico:</label>
                        <input type="email" class="form-control" id="id_correo" name="correo"
                            aria-describedby="emailHelp" >
                        <br>
                        <label for="id_clave" class="form-label">Contraseña:</label>
                        <input type="password" class="form-control" id="id_clave" name="clave"
                            aria-describedby="emailHelp">
                        <br>
                        <label for="id_clave_doble" class="form-label">Vuelve a escribir la contraseña:</label>
                        <input type="password" class="form-control" id="id_clave_doble" name="clave_doble"
                            aria-describedby="emailHelp">
                        <br>
                        <label for="id_genero" class="form-label">Género:</label>
                        <select class="form-control" id="id_genero" name="genero">
                            <option value="" disabled selected>Selecciona tu género</option>
                            <option value="H">Hombre</option>
                            <option value="M">Mujer</option>
                        </select>
                        <br>
                        <label for="id_fecha_nacimiento" class="form-label">Cuando naciste:</label><br>
                        <label style="font-size: 12px;" for="id_fecha_nacimiento" class="form-label">(Recuerda que debes ser mayor de 14 años)</label>
                        <input type="date" class="form-control" id="id_fecha_nacimiento" name="fecha_nacimiento"
                            aria-describedby="emailHelp">
                        <br>
                        <label for="imagen_perfil_label" class="form-label">¿Deseas       subir una imagen tuya?</label>
                        <br>
                        <input type="file" id="imagen_perfil" name="imagen_perfil">

                        <br><br>
                        <div class="buttons"></div>
                        <div id="cont_button" class="action_btn">
                            <button id="boton1" type="submit" class="btn btn-primary" id="custom-register-button" >
                                Registrarme 
                            </button>
                            <div style="width: 100px;">

                            </div>
                            <a id="boton1" href="{% url 'pantalla_login' %}" class="btn btn-primary"
                                id="custom-cancel-button">
                                Ya tengo cuenta
                            </a>
                            <p id="saved"></p>
                        </div>
                    </form>
                    <br>

                </div>
                <div id="cont_img">
                    <img id="img" alt="Imagen" src="{% static '/images/Man_sends_message.png'  %}">

                </div>
            </div>

        </main>
    </div>

</body>

</html>